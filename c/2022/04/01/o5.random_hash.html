<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Hash functions and pseudo-random number generation | Leo Martins Binfie Notes</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Hash functions and pseudo-random number generation" />
<meta name="author" content="Leo Martins" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Here I show two small tests, one with generation of an initial set of random numbers, and another on popcount() speeds, implemented in the low-level phylogenetic library biomcmc-lib." />
<meta property="og:description" content="Here I show two small tests, one with generation of an initial set of random numbers, and another on popcount() speeds, implemented in the low-level phylogenetic library biomcmc-lib." />
<link rel="canonical" href="https://leomrtns.github.io/jupyterblog/c/2022/04/01/o5.random_hash.html" />
<meta property="og:url" content="https://leomrtns.github.io/jupyterblog/c/2022/04/01/o5.random_hash.html" />
<meta property="og:site_name" content="Leo Martins Binfie Notes" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-04-01T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Hash functions and pseudo-random number generation" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Leo Martins"},"dateModified":"2022-04-01T00:00:00-05:00","datePublished":"2022-04-01T00:00:00-05:00","description":"Here I show two small tests, one with generation of an initial set of random numbers, and another on popcount() speeds, implemented in the low-level phylogenetic library biomcmc-lib.","headline":"Hash functions and pseudo-random number generation","mainEntityOfPage":{"@type":"WebPage","@id":"https://leomrtns.github.io/jupyterblog/c/2022/04/01/o5.random_hash.html"},"url":"https://leomrtns.github.io/jupyterblog/c/2022/04/01/o5.random_hash.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/jupyterblog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://leomrtns.github.io/jupyterblog/feed.xml" title="Leo Martins Binfie Notes" /><link rel="shortcut icon" type="image/x-icon" href="/jupyterblog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/jupyterblog/">Leo Martins Binfie Notes</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/jupyterblog/about/">About</a><a class="page-link" href="/jupyterblog/licence/">Licence</a><a class="page-link" href="/jupyterblog/search/">Search</a><a class="page-link" href="/jupyterblog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Hash functions and pseudo-random number generation</h1><p class="page-description">Here I show two small tests, one with generation of an initial set of random numbers, and another on `popcount()` speeds, implemented in the low-level phylogenetic library biomcmc-lib.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-04-01T00:00:00-05:00" itemprop="datePublished">
        Apr 1, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Leo Martins</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      5 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/jupyterblog/categories/#C">C</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/leomrtns/jupyterblog/tree/master/_notebooks/2022-04-01-o5.random_hash.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/jupyterblog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/leomrtns/jupyterblog/master?filepath=_notebooks%2F2022-04-01-o5.random_hash.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/jupyterblog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/leomrtns/jupyterblog/blob/master/_notebooks/2022-04-01-o5.random_hash.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/jupyterblog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fleomrtns%2Fjupyterblog%2Fblob%2Fmaster%2F_notebooks%2F2022-04-01-o5.random_hash.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/jupyterblog/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#005-Hash-functions-and-pseudo-random-number-generation">005 Hash functions and pseudo-random number generation </a>
<ul>
<li class="toc-entry toc-h2"><a href="#testing-the-generation-of-a-deterministic-array-of-random-numbers">testing the generation of a deterministic array of random numbers </a></li>
<li class="toc-entry toc-h2"><a href="#Counting-the-number-of-active-bits-(pop_count())">Counting the number of active bits (pop_count()) </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-04-01-o5.random_hash.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="005-Hash-functions-and-pseudo-random-number-generation">
<a class="anchor" href="#005-Hash-functions-and-pseudo-random-number-generation" aria-hidden="true"><span class="octicon octicon-link"></span></a>005 Hash functions and pseudo-random number generation<a class="anchor-link" href="#005-Hash-functions-and-pseudo-random-number-generation"> </a>
</h1>
<p>This notebook uses the low-level phylogenetic library <a href="https://github.com/quadram-institute-bioscience/biomcmc-lib">biomcmc-lib</a> (commit <a href="https://github.com/quadram-institute-bioscience/biomcmc-lib/commit/da29c5c9f76b5ee8d66f489fb7800abccf486ec2">da29c5c</a>).</p>
<p>Here I show two small tests, one with generation of an initial set of random numbers, and another on <code>popcount()</code> speeds.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="testing-the-generation-of-a-deterministic-array-of-random-numbers">
<a class="anchor" href="#testing-the-generation-of-a-deterministic-array-of-random-numbers" aria-hidden="true"><span class="octicon octicon-link"></span></a>testing the generation of a deterministic array of random numbers<a class="anchor-link" href="#testing-the-generation-of-a-deterministic-array-of-random-numbers"> </a>
</h2>
<p>In <code>biomcmc-lib</code> there are a few vectors with "random numbers" (some actually from <a href="random.org">random.org</a>, some random prime numbers used in hash functions, etc.). The function <code>biomcmc_salt_vector32_from_spice_table()</code> will populate a vector with these number in an order specified by the particular <code>seed[4]</code> values.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-c"><pre><span></span><span class="c1">//%cflags: -I/usr/users/QIB_fr005/deolivl/Academic/Quadram/009.supersptree/biomcmc-lib/lib</span>
<span class="c1">//%cflags: -I/usr/users/QIB_fr005/deolivl/Academic/Quadram/009.supersptree/build.191216/biomcmc-lib/lib</span>
<span class="c1">//%cflags: /usr/users/QIB_fr005/deolivl/Academic/Quadram/009.supersptree/build.191216/biomcmc-lib/lib/.libs/libbiomcmc.a</span>
<span class="c1">//%cflags:-lm</span>
<span class="cp">#include</span> <span class="cpf">&lt;biomcmc.h&gt;</span><span class="cp"></span>

<span class="kt">int</span>
<span class="nf">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">uint32_t</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">;</span>
    <span class="kt">uint32_t</span> <span class="n">seeds</span><span class="p">[]</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">},</span> <span class="n">vec</span><span class="p">[</span><span class="mi">32</span><span class="p">],</span> <span class="n">nvec</span><span class="o">=</span><span class="mi">34</span><span class="p">;</span>
    <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">c</span><span class="p">;</span>
    <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">vec</span><span class="p">);</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">seeds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="n">printf</span> <span class="p">(</span><span class="s">"%8x "</span><span class="p">,</span><span class="n">seeds</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
        <span class="n">printf</span> <span class="p">(</span><span class="s">"original seeds</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">biomcmc_salt_vector32_from_spice_table</span> <span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">nvec</span><span class="p">,</span> <span class="n">seeds</span><span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">seed: %u</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
        <span class="c1">//for (j=0; j&lt;nvec;j++) {printf("%12u ", vec[j]); if (!((j+1)%8)) printf ("\n"); }</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span> <span class="n">vec</span><span class="p">;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="k">sizeof</span> <span class="p">(</span><span class="n">vec</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(;</span> <span class="p">(</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">);</span> <span class="n">c</span><span class="o">++</span><span class="p">,</span> <span class="n">size</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span><span class="n">printf</span> <span class="p">(</span><span class="s">"%4x "</span><span class="p">,</span> <span class="o">*</span><span class="n">c</span><span class="p">);</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">((</span><span class="n">size</span><span class="mi">-1</span><span class="p">)</span><span class="o">%</span><span class="mi">16</span><span class="p">))</span> <span class="n">printf</span> <span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span> <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">15</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="n">printf</span> <span class="p">(</span><span class="s">"%8x "</span><span class="p">,</span><span class="n">biomcmc_hashint_salted</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
        <span class="n">printf</span> <span class="p">(</span><span class="s">"&lt;&lt; for hash %u</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
        
    <span class="k">return</span> <span class="n">EXIT_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>       0        1        2        3 original seeds

seed: 0
  15   da   f0   20   87   60   7f   24   ff   f0   9c   e2   87   7e    1    0 
  ff   ff   4f   46   ff   ff   27   23   d8   9a   b1   55   99    2   99   d7 
  85    5    c   d0   a6    f   a6   c4   9a   99   99   99   52   5a    7   8c 
  ae   11   92   3d   8f   e7    2    0   1d   60    0    0   1d   60    0    0 
  ed   6e   1c    1   fb   a5   71    7    9   f8   e6   5e   7b    a   9f    7 
  ff   ff   4b   59   ff   ff   f3   32   d7    5   f2   28   b7   27   3d   c8 
  fa   9e   6e   d6   4f   64   3f   6e   5c   52   ba   39   34   f8   d7   3a 
  2c   fc   1f   a0   46   7e    9    0   71   f7    2    0   1d   60    0    0 
       1 b621b33c 9cc8151d 5ab560c5 original seeds

seed: 1
  55   93   67   35   87   60   7f   24   2e   d1   9d   e2   7b   b3   31   35 
  ff   ff   7f   4c   ff   ff   da   33   fa   2f   b9   34   4d   26   48   46 
  fa   9e   6e   d6    e   8d   25   79   9f   da   f7   50   ee   a6   50   e1 
  e1   36   ce   6d   68   19   10    0    2   90   fd   2d   55   bd    4    0 
  89    a   50   1a    5   9e   41   2e   63   d1   e7   5e   eb   25   d4   19 
  ff   ff   92   6c   ff   ff   b9   30   c2   98   28   91   66   a9   5a   6f 
  fa   9e   6e   d6   30   6c   db   ea   99   3d   cc   5a   cf   a6   fc   ed 
  c0   13   ac   84   6a    0    9    0   a2   47   42   1a   f8   2b    1    0 
c0a9496a 27922c9d c6793575 87d06fbe &lt;&lt; for hash 0
6b4ed927 b48681b6 e267b84c 4f6e0e9c &lt;&lt; for hash 1
caa3caa3 12d60bf6 25ac1fe5 3882835c &lt;&lt; for hash 2
    d0dc   2a6ee1   55234f   7f181c &lt;&lt; for hash 3
deb66b58 deb66ab9 deb66a9a deb66afb &lt;&lt; for hash 4
2ba588a6 2ba58337 2ba51840 2ba510d1 &lt;&lt; for hash 5
acefdd39 ec26e4d2 75fe3d8c ce4259f1 &lt;&lt; for hash 6
4636b9c9 62baf5a0 ff4d1170 2bf062cf &lt;&lt; for hash 7
b7255c83 a63ec54b 2a674713 c0186ef5 &lt;&lt; for hash 8
ad92d5f0 8e953d2f 8f005635 cb773d1b &lt;&lt; for hash 9
e6546b64 e6546b64 e6546b64 e6546b64 &lt;&lt; for hash 10
c0a9496a 27922c9d c6793575 87d06fbe &lt;&lt; for hash 11
c0a9496a 27922c9d c6793575 87d06fbe &lt;&lt; for hash 12
c0a9496a 27922c9d c6793575 87d06fbe &lt;&lt; for hash 13
c0a9496a 27922c9d c6793575 87d06fbe &lt;&lt; for hash 14
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Counting-the-number-of-active-bits-(pop_count())">
<a class="anchor" href="#Counting-the-number-of-active-bits-(pop_count())" aria-hidden="true"><span class="octicon octicon-link"></span></a>Counting the number of active bits (<code>pop_count()</code>)<a class="anchor-link" href="#Counting-the-number-of-active-bits-(pop_count())"> </a>
</h2>
<p>I have recently implemented a few faster versions of 64 bits <em>popcounts</em>, and below I compare them with my first implementation — in the context of "bipartitions", which are vectors of bitstrings.</p>
<p>First I check if they are calculating the right thing (number of "ones" in a vector of 64 bit integers). And then I see which is faster. I expected <code>pop0()</code> to be slowest (it is linear on the number of active bits), and the others to be similar. Which is what we observe. The one I've chosen to be the new "default" on <code>biomcmc-lib</code> is <code>pop1()</code>, which I've seen in <a href="https://github.com/ruanjue/wtdbg">Jue Ruan's RedBean</a> and also in <a href="https://github.com/KChen-lab/novoBreak">novoBreak</a>. The previous default was the <code>i &amp;= i -1</code> trick described in K &amp; R. The other two are from <a href="http://www.dalkescientific.com/writings/diary/archive/2008/07/03/hakmem_and_other_popcounts.html">Andrew Dalke</a>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-c"><pre><span></span><span class="c1">//%cflags: -I/usr/users/QIB_fr005/deolivl/Academic/Quadram/009.supersptree/biomcmc-lib/lib</span>
<span class="c1">//%cflags: -I/usr/users/QIB_fr005/deolivl/Academic/Quadram/009.supersptree/build.191216/biomcmc-lib/lib</span>
<span class="c1">//%cflags: /usr/users/QIB_fr005/deolivl/Academic/Quadram/009.supersptree/build.191216/biomcmc-lib/lib/.libs/libbiomcmc.a</span>
<span class="c1">//%cflags:-lm</span>
<span class="cp">#include</span> <span class="cpf">&lt;biomcmc.h&gt;</span><span class="cp"></span>

<span class="kt">int</span>
<span class="nf">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">uint32_t</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span> <span class="n">n_iter</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">;</span>
    <span class="kt">clock_t</span> <span class="n">time0</span><span class="p">,</span> <span class="n">time1</span><span class="p">;</span>
    <span class="n">bipartition</span> <span class="n">bp</span> <span class="o">=</span> <span class="n">new_bipartition</span> <span class="p">(</span><span class="mi">70</span><span class="p">);</span>
    <span class="n">biomcmc_random_number_init</span> <span class="p">(</span><span class="mi">0ULL</span><span class="p">);</span>
    <span class="n">printf</span> <span class="p">(</span><span class="s">"STEP 1 : check that all pop counts are correct</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">n</span><span class="o">-&gt;</span><span class="n">ints</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">bp</span><span class="o">-&gt;</span><span class="n">bs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">biomcmc_rng_get</span> <span class="p">();</span>
        <span class="p">}</span>
        <span class="n">bipartition_print_to_stdout</span> <span class="p">(</span><span class="n">bp</span><span class="p">);</span>
        <span class="n">printf</span> <span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">%4d %4d %4d %4d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> 
                <span class="n">bipartition_count_n_ones_pop0</span><span class="p">(</span><span class="n">bp</span><span class="p">),</span>
                <span class="n">bipartition_count_n_ones_pop1</span><span class="p">(</span><span class="n">bp</span><span class="p">),</span>
                <span class="n">bipartition_count_n_ones_pop2</span><span class="p">(</span><span class="n">bp</span><span class="p">),</span>
                <span class="n">bipartition_count_n_ones_pop3</span><span class="p">(</span><span class="n">bp</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="n">del_bipartition</span> <span class="p">(</span><span class="n">bp</span><span class="p">);</span> <span class="n">bp</span> <span class="o">=</span> <span class="n">new_bipartition</span> <span class="p">(</span><span class="mi">50000</span><span class="p">);</span> <span class="c1">// bigger bipartition</span>
    <span class="n">printf</span> <span class="p">(</span><span class="s">"STEP 2: time pop counts (pop1 is default, and we call through a wrapper to discount this overhead)</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">time0</span> <span class="o">=</span> <span class="n">clock</span> <span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n_iter</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">n</span><span class="o">-&gt;</span><span class="n">ints</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">bs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">biomcmc_rng_get</span> <span class="p">();</span>
        <span class="n">bipartition_count_n_ones</span> <span class="p">(</span><span class="n">bp</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">time1</span> <span class="o">=</span> <span class="n">clock</span> <span class="p">();</span> <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">"pop1: %.8f secs</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">time1</span><span class="o">-</span><span class="n">time0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">CLOCKS_PER_SEC</span><span class="p">);</span>
    <span class="n">time0</span> <span class="o">=</span> <span class="n">time1</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n_iter</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">n</span><span class="o">-&gt;</span><span class="n">ints</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">bs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">biomcmc_rng_get</span> <span class="p">();</span>
        <span class="n">bipartition_count_n_ones_pop0</span> <span class="p">(</span><span class="n">bp</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">time1</span> <span class="o">=</span> <span class="n">clock</span> <span class="p">();</span> <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">"pop0: %.8f secs</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">time1</span><span class="o">-</span><span class="n">time0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">CLOCKS_PER_SEC</span><span class="p">);</span>
    <span class="n">time0</span> <span class="o">=</span> <span class="n">time1</span><span class="p">;</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n_iter</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">n</span><span class="o">-&gt;</span><span class="n">ints</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">bs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">biomcmc_rng_get</span> <span class="p">();</span>
        <span class="n">bipartition_count_n_ones_pop2</span> <span class="p">(</span><span class="n">bp</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">time1</span> <span class="o">=</span> <span class="n">clock</span> <span class="p">();</span> <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">"pop2: %.8f secs</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">time1</span><span class="o">-</span><span class="n">time0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">CLOCKS_PER_SEC</span><span class="p">);</span>
    <span class="n">time0</span> <span class="o">=</span> <span class="n">time1</span><span class="p">;</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n_iter</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">n</span><span class="o">-&gt;</span><span class="n">ints</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="n">bp</span><span class="o">-&gt;</span><span class="n">bs</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">biomcmc_rng_get</span> <span class="p">();</span>
        <span class="n">bipartition_count_n_ones_pop3</span> <span class="p">(</span><span class="n">bp</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">time1</span> <span class="o">=</span> <span class="n">clock</span> <span class="p">();</span> <span class="n">fprintf</span> <span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">"pop3: %.8f secs</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">time1</span><span class="o">-</span><span class="n">time0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">CLOCKS_PER_SEC</span><span class="p">);</span>
    <span class="n">time0</span> <span class="o">=</span> <span class="n">time1</span><span class="p">;</span>
    
    <span class="n">del_bipartition</span> <span class="p">(</span><span class="n">bp</span><span class="p">);</span>
    <span class="n">biomcmc_random_number_finalize</span> <span class="p">();</span>
    <span class="k">return</span> <span class="n">EXIT_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>STEP 1 : check that all pop counts are correct
1111101010010110110000001011111000010001001000010111110100110101.001010[0] 	  34   34   34   34
1011001001011101101010010000011101001100100001111101011110110010.011010[34] 	  36   36   36   36
0000101001000100011000111111100000011010001001000110110100001110.011010[36] 	  29   29   29   29
1010001100100100100001000000010101111111101000011110111110001100.100100[29] 	  32   32   32   32
STEP 2: time pop counts (pop1 is default, and we call through a wrapper to discount this overhead)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>pop1: 0.19077800 secs
pop0: 0.37243400 secs
pop2: 0.20049800 secs
pop3: 0.19488300 secs
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="leomrtns/jupyterblog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/jupyterblog/c/2022/04/01/o5.random_hash.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/jupyterblog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/jupyterblog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/jupyterblog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Notes on Evolutionary Computational Biology and Bioinformatics</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/leomrtns" target="_blank" title="leomrtns"><svg class="svg-icon grey"><use xlink:href="/jupyterblog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/leomrtns" target="_blank" title="leomrtns"><svg class="svg-icon grey"><use xlink:href="/jupyterblog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
